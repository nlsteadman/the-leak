{"ast":null,"code":"var _jsxFileName = \"/Users/endor/Flatiron/code/the-leak/client/src/context/MyContext.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { headers, getToken, baseUrl } from '../components/Globals';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MyContext = /*#__PURE__*/React.createContext();\n\nconst MyProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [currentUser, setCurrentUser] = useState({});\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [locations, setLocations] = useState([]);\n  const [locationTypes, setLocationTypes] = useState([]);\n  const [products, setProducts] = useState([]);\n  const [reviews, setReviews] = useState([]);\n\n  const loginUser = user => {\n    if (user) {\n      setCurrentUser(user);\n      setLoggedIn(true);\n    } else {\n      setCurrentUser(null);\n      setLoggedIn(false);\n      alert(\"This user doesn't exist\");\n    }\n  };\n\n  const logoutUser = () => {\n    setCurrentUser({});\n    setLoggedIn(false);\n    localStorage.removeItem('jwt');\n  };\n\n  useEffect(() => {\n    const token = localStorage.getItem('jwt');\n\n    if (token && !loggedIn) {\n      fetch(baseUrl + '/get-current-user', {\n        method: \"GET\",\n        headers: { ...headers,\n          ...getToken()\n        }\n      }).then(r => r.json()).then(user => loginUser(user));\n    }\n\n    fetch(baseUrl + '/locations', {\n      headers: { ...headers,\n        ...getToken()\n      }\n    }).then(r => r.json()).then(data => setLocations(data));\n\n    if (loggedIn) {\n      fetch(baseUrl + '/products', {\n        headers: { ...headers,\n          ...getToken()\n        }\n      }).then(r => r.json()).then(data => setProducts(data));\n    }\n\n    if (loggedIn) {\n      fetch(baseUrl + '/reviews', {\n        headers: { ...headers,\n          ...getToken()\n        }\n      }).then(r => r.json()).then(data => setReviews(data));\n    }\n\n    if (location_types) {\n      fetch(baseUrl + '/location_types', {\n        headers: { ...headers,\n          ...getToken()\n        }\n      }).then(r => r.json()).then(data => setLocationTypes(data));\n    }\n  }, [loggedIn]);\n\n  const addToList = review => {\n    setReviews([...reviews, review]);\n  };\n\n  const updateReview = review => {\n    setReviews(reviews.map(r => r.id === review.id ? review : r));\n  };\n\n  const deleteReview = review => {\n    setReviews(reviews.filter(r => r.id !== review.id));\n  };\n\n  return /*#__PURE__*/_jsxDEV(MyContext.Provider, {\n    value: {\n      currentUser,\n      loggedIn,\n      loginUser,\n      logoutUser,\n      locations,\n      locationTypes,\n      products,\n      reviews,\n      addToList,\n      updateReview,\n      deleteReview\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MyProvider, \"Szt9F5xZL4BM5KMUyKn36w55LOU=\");\n\n_c = MyProvider;\nexport { MyContext, MyProvider };\n\nvar _c;\n\n$RefreshReg$(_c, \"MyProvider\");","map":{"version":3,"names":["React","useState","useEffect","headers","getToken","baseUrl","MyContext","createContext","MyProvider","children","currentUser","setCurrentUser","loggedIn","setLoggedIn","locations","setLocations","locationTypes","setLocationTypes","products","setProducts","reviews","setReviews","loginUser","user","alert","logoutUser","localStorage","removeItem","token","getItem","fetch","method","then","r","json","data","location_types","addToList","review","updateReview","map","id","deleteReview","filter"],"sources":["/Users/endor/Flatiron/code/the-leak/client/src/context/MyContext.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { headers, getToken, baseUrl } from '../components/Globals';\n\nconst MyContext = React.createContext();\n\nconst MyProvider = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState({});\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [locations, setLocations] = useState([]);\n  const [locationTypes, setLocationTypes] = useState([]);\n  const [products, setProducts] = useState([]);\n  const [reviews, setReviews] = useState([]);\n\n  \n  const loginUser = user => {\n    if (user) {\n      setCurrentUser(user);\n      setLoggedIn(true);\n    } else {\n      setCurrentUser(null);\n      setLoggedIn(false);\n      alert(\"This user doesn't exist\");\n    }\n  }\n\n  const logoutUser = () => {\n    setCurrentUser({});\n    setLoggedIn(false);\n    localStorage.removeItem('jwt');\n  }  \n\n  useEffect(() => {\n    const token = localStorage.getItem('jwt')\n    if(token && !loggedIn) {\n      fetch(baseUrl + '/get-current-user', {\n        method: \"GET\",\n        headers: {\n          ...headers,\n          ...getToken()\n        }\n      })\n        .then(r => r.json())\n        .then(user => loginUser(user))\n    }\n\n    fetch(baseUrl + '/locations', {\n      headers: {\n        ...headers,\n        ...getToken()\n      }\n    })\n      .then(r => r.json())\n      .then(data => setLocations(data))\n\n    if(loggedIn) {\n      fetch(baseUrl + '/products', {\n        headers: {\n          ...headers,\n          ...getToken()\n        }\n      })\n        .then(r => r.json())\n        .then(data => setProducts(data))\n    }  \n\n    if(loggedIn) {\n      fetch(baseUrl + '/reviews', {\n        headers: {\n            ...headers,\n            ...getToken()\n        }\n      })\n        .then(r => r.json())\n        .then(data => setReviews(data))\n    }\n\n    if(location_types) {\n      fetch(baseUrl + '/location_types', {\n        headers: {\n            ...headers,\n            ...getToken()\n        }\n      })\n        .then(r => r.json())\n        .then(data => setLocationTypes(data))\n    }\n  }, [loggedIn])\n\n  const addToList = review => {\n    setReviews([...reviews, review]);\n  }\n\n  const updateReview = review => {\n    setReviews(reviews.map(r => r.id === review.id ? review : r))\n  }\n\n  const deleteReview = review => {\n    setReviews(reviews.filter(r => r.id !== review.id))\n  }\n\n\n  return (\n    <MyContext.Provider value={{\n      currentUser,\n      loggedIn,\n      loginUser,\n      logoutUser,\n      locations,\n      locationTypes,\n      products,\n      reviews,\n      addToList,\n      updateReview,\n      deleteReview\n    }}>\n      { children }\n    </MyContext.Provider>\n  )\n  \n}\n\n\n\nexport { MyContext, MyProvider };"],"mappings":"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"},"metadata":{},"sourceType":"module"}